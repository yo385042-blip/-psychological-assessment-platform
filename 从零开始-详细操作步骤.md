# 🚀 从零开始 - 详细操作步骤

## 📋 完整流程：从初始化 Git 到部署成功

这个指南会一步一步详细指导你完成所有操作。

---

## 📦 第 1 部分：初始化 Git 并推送代码到 GitHub

### 步骤 1：打开 PowerShell 窗口

**方法 1（推荐）：**

1. **打开文件资源管理器**
2. **导航到项目文件夹：**
   ```
   C:\Users\26872\Desktop\心理网站编写\02 管理器 - 副本 - 副本
   ```
3. **在文件夹中：**
   - 按住键盘上的 **`Shift`** 键（不要松开）
   - 在空白处 **右键点击**
   - 选择 **"在此处打开 PowerShell 窗口"** 或 **"在此处打开命令提示符"**

**方法 2：**

1. **按 `Win + X`**
2. **选择 "Windows PowerShell" 或 "终端"**
3. **运行以下命令：**
   ```powershell
   cd "C:\Users\26872\Desktop\心理网站编写\02 管理器 - 副本 - 副本"
   ```

---

### 步骤 2：检查是否已经是 Git 仓库

**在 PowerShell 窗口中，输入以下命令并按 Enter：**

```powershell
git status
```

**查看结果：**

#### ✅ 情况 A：已经是 Git 仓库

如果看到类似：
```
On branch main
...
```
→ **说明已经是 Git 仓库，跳转到步骤 4**

#### ❌ 情况 B：还不是 Git 仓库

如果看到错误：
```
fatal: not a git repository
```
→ **继续步骤 3，初始化 Git 仓库**

---

### 步骤 3：初始化 Git 仓库

**如果还不是 Git 仓库，运行以下命令：**

#### 3.1 初始化 Git

```powershell
git init
```

**输出应该显示：**
```
Initialized empty Git repository in ...
```

#### 3.2 设置默认分支名称

```powershell
git branch -M main
```

#### 3.3 添加远程仓库

```powershell
git remote add origin https://github.com/yo385042-blip/mindcube.git
```

**如果已经存在远程仓库，可以跳过这一步，或者先检查：**

```powershell
git remote -v
```

---

### 步骤 4：检查 Git 状态

**运行：**

```powershell
git status
```

**查看输出：**

应该看到很多未跟踪的文件（Untracked files），包括：
- ✅ `src/` 文件夹
- ✅ `functions/` 文件夹
- ✅ `public/` 文件夹
- ✅ 各种配置文件

**确认：**
- ❌ 没有看到 `node_modules/` 文件夹（应该被忽略）
- ❌ 没有看到 `dist/` 文件夹（应该被忽略）

---

### 步骤 5：添加所有文件到 Git

**运行：**

```powershell
git add .
```

**等待命令完成**（可能需要几秒钟）

---

### 步骤 6：确认添加的文件

**再次运行：**

```powershell
git status
```

**确认看到：**

```
Changes to be committed:
  new file:   src/...
  new file:   functions/_middleware.js
  new file:   public/_redirects
  ...
```

**确认：**
- ✅ 看到了很多文件被添加
- ❌ 仍然没有看到 `node_modules/` 或 `dist/`

---

### 步骤 7：提交更改

**运行：**

```powershell
git commit -m "添加完整项目代码和配置"
```

**或者更详细的提交信息：**

```powershell
git commit -m "添加完整项目代码和配置

- 添加源代码和组件
- 添加 Functions 中间件
- 添加构建配置和脚本
- 添加公共文件（_redirects 等）"
```

**等待提交完成**，会显示类似：
```
[main (root-commit) xxxxx] 添加完整项目代码和配置
 X files changed, Y insertions(+)
```

---

### 步骤 8：推送到 GitHub

**运行：**

```powershell
git push -u origin main
```

**如果分支是 master，运行：**

```powershell
git push -u origin master
```

**可能的情况：**

#### 情况 A：需要认证

如果提示输入用户名和密码：
1. **输入你的 GitHub 用户名**
2. **输入密码**（或者 Personal Access Token）

#### 情况 B：已经认证

如果直接开始推送，等待完成即可。

**等待推送完成**，会显示类似：
```
To https://github.com/yo385042-blip/mindcube.git
 * [new branch]      main -> main
Branch 'main' set up to track remote branch 'main' from 'origin'.
```

---

### 步骤 9：验证推送成功

1. **打开浏览器**
2. **访问：** https://github.com/yo385042-blip/mindcube
3. **刷新页面**（按 F5）
4. **检查仓库内容：**
   - ✅ 应该看到 `src/` 文件夹
   - ✅ 应该看到 `functions/` 文件夹（在根目录）
   - ✅ 应该看到 `public/` 文件夹
   - ✅ 应该看到 `package.json`
   - ❌ 不应该看到 `dist/` 文件夹
   - ❌ 不应该看到 `node_modules/` 文件夹

**如果看到了这些文件，✅ 第一部分完成！**

---

## ⚙️ 第 2 部分：配置 Cloudflare Pages 构建

### 步骤 10：打开 Cloudflare Dashboard

1. **打开浏览器**（新标签页）
2. **访问：** https://dash.cloudflare.com/
3. **登录你的账户**

---

### 步骤 11：进入 Pages 项目

1. **在左侧菜单中，找到并点击：**
   - **"Workers & Pages"** 或 **"Workers 和 Pages"**

2. **点击你的项目**
   - 可能是 `psytest.store` 或 `mindcube`
   - 在项目列表中点击项目名称

---

### 步骤 12：进入设置页面

1. **在项目页面顶部，你会看到几个标签：**
   - 资产已上传
   - 函数
   - 重定向
   - 标头
   - **设置** ← **点击这个！**

2. **点击 "设置" (Settings) 标签**

---

### 步骤 13：找到构建设置

1. **在设置页面中，查找：**
   - **"Builds & deployments"** 或
   - **"构建和部署"**

2. **可能的位置：**
   - 左侧菜单中
   - 页面中间部分
   - 设置页面的主要区域

3. **点击进入构建配置部分**

---

### 步骤 14：配置框架预设（如果有）

1. **找到 "Framework preset" 或 "框架预设" 下拉菜单**

2. **选择：**
   - **None**（无）← 推荐

---

### 步骤 15：配置构建命令

1. **找到 "Build command" 或 "构建命令" 输入框**

2. **点击输入框，清空原有内容（如果有）**

3. **输入：**
   ```
   npm run build
   ```

4. **确认输入正确**

---

### 步骤 16：配置构建输出目录

1. **找到 "Output directory" 或 "构建输出目录" 输入框**

2. **点击输入框，清空原有内容（如果有）**

3. **输入：**
   ```
   dist
   ```

4. **确认输入正确**（小写字母，没有多余空格）

---

### 步骤 17：配置根目录

1. **找到 "Root directory" 或 "根目录" 输入框**

2. **留空**（不输入任何内容）
   - 这表示使用项目根目录

---

### 步骤 18：配置 Node.js 版本

1. **找到 "Node.js version" 或 "Node.js 版本" 下拉菜单**

2. **点击下拉菜单**

3. **选择：**
   - **18** ← 推荐

---

### 步骤 19：最终确认配置

**在保存之前，确认所有设置如下：**

```
框架预设：None（或无）
构建命令：npm run build
构建输出目录：dist
根目录：（留空）
Node.js 版本：18
```

**检查每个字段，确保都正确！**

---

### 步骤 20：保存设置

1. **滚动到页面底部**

2. **找到 "保存" (Save) 按钮**
   - 通常是绿色或蓝色的按钮

3. **点击 "保存" (Save) 按钮**

4. **等待保存完成**
   - 页面可能会刷新
   - 或显示 "设置已保存" 的提示

**如果看到保存成功的提示，✅ 第二部分完成！**

---

## 🔄 第 3 部分：触发重新部署

### 步骤 21：触发重新部署（选择一种方式）

#### 方式 A：推送新提交（推荐）

**回到 PowerShell 窗口，运行：**

```powershell
git commit --allow-empty -m "触发 Cloudflare Pages 重新构建"
```

**然后推送：**

```powershell
git push origin main
```

**等待推送完成。**

#### 方式 B：手动重新部署

1. **在 Cloudflare Pages 项目页面**
2. **点击 "部署" (Deployments) 标签**
3. **找到最新部署，点击右侧的三个点（...）**
4. **选择 "重新部署" 或 "Retry deployment"**

---

### 步骤 22：等待部署开始

**Cloudflare Pages 会自动开始构建和部署，通常需要 2-5 分钟。**

---

## ✅ 第 4 部分：验证部署

### 步骤 23：查看构建日志

1. **在 Cloudflare Pages 项目页面**
2. **点击 "部署" (Deployments) 标签**
3. **点击最新的部署**

### 步骤 24：检查构建日志

**在构建日志中，应该看到以下步骤：**

#### ✅ 步骤 1：克隆仓库
```
Cloning repository...
Success: Finished cloning repository files
```

#### ✅ 步骤 2：安装依赖
```
Installing dependencies...
Running npm install...
```

#### ✅ 步骤 3：运行构建命令
```
Running build command...
npm run build
```

#### ✅ 步骤 4：构建输出
```
✓ TypeScript compilation
✓ Vite build
✓ Functions directory copied to dist successfully!
```

#### ✅ 步骤 5：部署成功
```
Success: Assets published!
Success: Your site was deployed!
```

### 步骤 25：确认没有错误

**确认日志中：**
- ❌ **没有** "No build command specified"
- ❌ **没有** "No functions dir found"
- ✅ **有** "Running build command"
- ✅ **有** "Functions directory copied"

### 步骤 26：检查 Functions

1. **在部署详情页面**
2. **点击顶部的 "函数" (Functions) 标签**
3. **应该看到：**
   - ✅ `_middleware.js` 函数
   - ✅ 状态为 Active 或 Deployed

---

## 🧪 第 5 部分：测试网站

### 步骤 27：找到网站 URL

1. **在部署详情页面**
2. **查找网站 URL**
   - 通常在页面顶部
   - 格式：`https://psytest.store.pages.dev` 或类似

### 步骤 28：访问网站

1. **在浏览器中打开新标签页**
2. **访问网站 URL**
3. **等待页面加载**

### 步骤 29：测试首页

- ✅ 页面是否能正常打开？
- ✅ 是否显示内容？
- ✅ 是否有错误？

### 步骤 30：测试路由

1. **测试 `/login` 路由：**
   - 在地址栏输入：`你的网站URL/login`
   - 按 Enter
   - ✅ 是否能正常打开？

2. **测试 `/dashboard` 路由：**
   - 在地址栏输入：`你的网站URL/dashboard`
   - 按 Enter
   - ✅ 是否能正常打开？

---

## 🎉 完成！

**如果所有步骤都成功完成：**

- ✅ 代码已推送到 GitHub
- ✅ Cloudflare Pages 已配置构建命令
- ✅ 部署成功
- ✅ 网站能正常访问
- ✅ 路由正常工作

**恭喜你！网站现在已经完全配置好了！**

---

## 📞 如果遇到问题

在任何步骤遇到问题时：

1. **停止操作**
2. **记录错误信息**
3. **告诉我：**
   - 你在哪一步
   - 具体的错误信息
   - 你执行了什么命令
4. **我会帮你解决问题**

---

## 🎯 现在开始执行

**按照上面的步骤，一步一步执行：**

1. ✅ 步骤 1-9：推送代码到 GitHub
2. ✅ 步骤 10-20：配置 Cloudflare Pages 构建
3. ✅ 步骤 21-22：触发重新部署
4. ✅ 步骤 23-26：验证部署
5. ✅ 步骤 27-30：测试网站

**开始吧！从步骤 1 开始！**

