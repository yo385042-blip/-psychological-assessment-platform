# ğŸ”§ æœ€ç»ˆè§£å†³æ–¹æ¡ˆ - æ›´æ”¹ Cloudflare Pages æ„å»ºå‘½ä»¤

## ğŸ” é—®é¢˜åˆ†æ

è™½ç„¶æˆ‘ä»¬å·²ç»ï¼š
- âœ… ä¿®æ”¹äº† `vite.config.ts`ï¼ˆä½¿ç”¨ esbuildï¼‰
- âœ… é‡æ–°ç”Ÿæˆäº† `package-lock.json`

ä½† Cloudflare Pages ä½¿ç”¨ `npm ci`ï¼ˆclean installï¼‰æ—¶ä»ç„¶æŠ¥é”™ã€‚

**é—®é¢˜æ ¹æºï¼š** `npm ci` è¦æ±‚ `package.json` å’Œ `package-lock.json` å®Œå…¨åŒæ­¥ï¼Œä½†å¯èƒ½å­˜åœ¨ç»†å¾®å·®å¼‚ã€‚

---

## âœ… è§£å†³æ–¹æ¡ˆï¼šæ›´æ”¹ Cloudflare Pages æ„å»ºå‘½ä»¤

### æ–¹æ³• 1ï¼šä½¿ç”¨ `npm install` ä»£æ›¿ `npm ci`

æˆ‘ä»¬å¯ä»¥ä¿®æ”¹ Cloudflare Pages çš„æ„å»ºé…ç½®ï¼Œä½¿ç”¨ `npm install` ä»£æ›¿é»˜è®¤çš„ `npm ci`ã€‚

---

## ğŸ¯ æ­¥éª¤ 1ï¼šæ£€æŸ¥å½“å‰æ„å»ºé…ç½®

1. **è®¿é—® Cloudflare Dashboardï¼š** https://dash.cloudflare.com/
2. **Workers & Pages â†’ ä½ çš„é¡¹ç›® â†’ è®¾ç½® (Settings)**
3. **æŸ¥çœ‹æ„å»ºé…ç½®ï¼š**
   - æ„å»ºå‘½ä»¤ï¼š`npm run build`
   - è¾“å‡ºç›®å½•ï¼š`dist`

---

## ğŸ¯ æ­¥éª¤ 2ï¼šæ·»åŠ ç¯å¢ƒå˜é‡æˆ–ä¿®æ”¹æ„å»ºå‘½ä»¤

### é€‰é¡¹ Aï¼šæ·»åŠ ç¯å¢ƒå˜é‡ï¼ˆæ¨èï¼‰

åœ¨ Cloudflare Pages è®¾ç½®ä¸­ï¼š
1. **æ‰¾åˆ° "ç¯å¢ƒå˜é‡" (Environment Variables) æˆ– "å˜é‡å’Œæœºå¯†" (Variables and Secrets)**
2. **æ·»åŠ ç¯å¢ƒå˜é‡ï¼š**
   - åç§°ï¼š`NPM_FLAGS`
   - å€¼ï¼š`--legacy-peer-deps`ï¼ˆæˆ–ç•™ç©ºï¼Œä½¿ç”¨é»˜è®¤è¡Œä¸ºï¼‰

### é€‰é¡¹ Bï¼šä¿®æ”¹æ„å»ºå‘½ä»¤

å°†æ„å»ºå‘½ä»¤æ”¹ä¸ºï¼š

```
npm install && npm run build
```

---

## ğŸ¯ æ­¥éª¤ 3ï¼šæˆ–è€…ï¼Œç›´æ¥åœ¨æœ¬åœ°æ·»åŠ  .npmrc æ–‡ä»¶

åˆ›å»ºä¸€ä¸ª `.npmrc` æ–‡ä»¶ï¼Œé…ç½® npm çš„è¡Œä¸ºï¼š

### åˆ›å»º `.npmrc` æ–‡ä»¶

åˆ›å»ºæ–‡ä»¶ `.npmrc`ï¼ˆåœ¨é¡¹ç›®æ ¹ç›®å½•ï¼‰ï¼Œå†…å®¹ï¼š

```
legacy-peer-deps=true
```

æˆ–è€…ï¼š

```
package-lock=false
```

---

## ğŸ¯ æ­¥éª¤ 4ï¼šæœ€ç®€å•çš„æ–¹æ³• - æ·»åŠ é¢„å®‰è£…è„šæœ¬

ä¿®æ”¹ `package.json`ï¼Œæ·»åŠ  `preinstall` è„šæœ¬ï¼š

```json
"scripts": {
  "preinstall": "npm install --package-lock-only --legacy-peer-deps || true",
  "dev": "vite",
  "build": "tsc && vite build && npm run copy-functions",
  ...
}
```

ä½†è¿™å¯èƒ½è¿‡äºå¤æ‚ã€‚

---

## ğŸ¯ æœ€ç®€å•çš„è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ npm install è€Œä¸æ˜¯ npm ci

### åœ¨ Cloudflare Pages è®¾ç½®ä¸­

1. **æ‰¾åˆ°æ„å»ºå‘½ä»¤è®¾ç½®**
2. **å°†æ„å»ºå‘½ä»¤æ”¹ä¸ºï¼š**

```
npm install && npm run build
```

è¿™æ · Cloudflare Pages ä¼šä½¿ç”¨ `npm install` è€Œä¸æ˜¯ `npm ci`ã€‚

---

## ğŸ“‹ å®Œæ•´æ“ä½œæ­¥éª¤

### æ–¹æ³• 1ï¼šä¿®æ”¹ Cloudflare Pages æ„å»ºå‘½ä»¤

1. **è®¿é—® Cloudflare Dashboard**
2. **Workers & Pages â†’ ä½ çš„é¡¹ç›® â†’ è®¾ç½®**
3. **æ‰¾åˆ° "æ„å»ºé…ç½®"**
4. **ä¿®æ”¹æ„å»ºå‘½ä»¤ä¸ºï¼š**
   ```
   npm install && npm run build
   ```
5. **ä¿å­˜è®¾ç½®**
6. **æ‰‹åŠ¨è§¦å‘ä¸€æ¬¡éƒ¨ç½²**

---

### æ–¹æ³• 2ï¼šæ·»åŠ  .npmrc æ–‡ä»¶

1. **åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `.npmrc` æ–‡ä»¶**
2. **å†…å®¹ï¼š**
   ```
   package-lock-only=false
   ```
3. **æäº¤å¹¶æ¨é€ï¼š**
   ```powershell
   git add .npmrc
   git commit -m "æ·»åŠ  .npmrc é…ç½®æ–‡ä»¶"
   git push origin main
   ```

---

## ğŸ¯ æ¨èæ“ä½œ

**æˆ‘æ¨èä½¿ç”¨æ–¹æ³• 1ï¼šåœ¨ Cloudflare Pages è®¾ç½®ä¸­ä¿®æ”¹æ„å»ºå‘½ä»¤ã€‚**

**ä¿®æ”¹ä¸ºï¼š**
```
npm install && npm run build
```

è¿™æ · Cloudflare Pages ä¼šä½¿ç”¨ `npm install` è€Œä¸æ˜¯ `npm ci`ï¼Œå°±ä¸ä¼šæœ‰åŒæ­¥æ£€æŸ¥çš„é—®é¢˜äº†ã€‚

---

## ğŸ¯ ç°åœ¨è¯·æ‰§è¡Œ

1. âœ… **è®¿é—® Cloudflare Dashboard**
2. âœ… **è¿›å…¥é¡¹ç›®è®¾ç½®**
3. âœ… **ä¿®æ”¹æ„å»ºå‘½ä»¤ä¸ºï¼š`npm install && npm run build`**
4. âœ… **ä¿å­˜å¹¶æ‰‹åŠ¨è§¦å‘éƒ¨ç½²**

æˆ–è€…å‘Šè¯‰æˆ‘ä½ æƒ³ä½¿ç”¨å“ªç§æ–¹æ³•ï¼Œæˆ‘ä¼šç»§ç»­å¸®ä½ ï¼ğŸš€

