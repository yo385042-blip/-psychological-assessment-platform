# éƒ¨ç½²å‘½ä»¤

## ğŸ“‹ å¿«é€Ÿéƒ¨ç½²å‘½ä»¤

### 1. å®‰è£…ä¾èµ–ï¼ˆå¦‚æœè¿˜æ²¡æœ‰å®‰è£…ï¼‰
```bash
npm install
```

### 2. æ„å»ºé¡¹ç›®
```bash
npm run build
```

è¿™ä¸ªå‘½ä»¤ä¼šæ‰§è¡Œï¼š
- TypeScript ç±»å‹æ£€æŸ¥
- Vite æ„å»ºå‰ç«¯èµ„æº
- å¤åˆ¶ functions ç›®å½•åˆ° dist

### 3. éƒ¨ç½²åˆ° Cloudflare Pages

#### æ–¹å¼Aï¼šä½¿ç”¨ Wrangler CLIï¼ˆæ¨èç”¨äºæ‰‹åŠ¨éƒ¨ç½²ï¼‰

```bash
# å®‰è£… Wranglerï¼ˆå¦‚æœè¿˜æ²¡æœ‰å®‰è£…ï¼‰
npm install -g wrangler

# ç™»å½• Cloudflare
wrangler login

# éƒ¨ç½²
wrangler pages deploy dist
```

#### æ–¹å¼Bï¼šé€šè¿‡ GitHub è‡ªåŠ¨éƒ¨ç½²ï¼ˆæ¨èç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰

1. **æäº¤ä»£ç åˆ° GitHub**
```bash
git add .
git commit -m "å‡†å¤‡éƒ¨ç½²"
git push origin main
```

2. **åœ¨ Cloudflare Dashboard ä¸­é…ç½®**
   - è¿›å…¥ Cloudflare Dashboard > Pages
   - åˆ›å»ºæ–°é¡¹ç›®æˆ–é€‰æ‹©ç°æœ‰é¡¹ç›®
   - è¿æ¥åˆ° GitHub ä»“åº“
   - é…ç½®æ„å»ºè®¾ç½®ï¼ˆè§ä¸‹æ–¹ï¼‰

## ğŸ”§ Cloudflare Pages æ„å»ºè®¾ç½®

åœ¨ Cloudflare Dashboard ä¸­é…ç½®ä»¥ä¸‹è®¾ç½®ï¼š

- **Framework preset**: None
- **Build command**: `npm run build`
- **Build output directory**: `dist`
- **Root directory**: `/` (ç•™ç©ºæˆ–å¡« `/`)
- **Node version**: `18` æˆ–æ›´é«˜

## ğŸ“¦ å®Œæ•´éƒ¨ç½²æµç¨‹

### æœ¬åœ°æµ‹è¯•éƒ¨ç½²

```bash
# 1. ç¡®ä¿ä¾èµ–å·²å®‰è£…
npm install

# 2. æ„å»ºé¡¹ç›®
npm run build

# 3. æ£€æŸ¥ dist ç›®å½•
# åº”è¯¥åŒ…å«ï¼š
# - dist/index.html
# - dist/assets/
# - dist/functions/

# 4. æœ¬åœ°é¢„è§ˆï¼ˆå¯é€‰ï¼‰
npm run preview
```

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

```bash
# 1. ç¡®ä¿æ‰€æœ‰æ›´æ”¹å·²æäº¤
git status

# 2. æäº¤ä»£ç 
git add .
git commit -m "éƒ¨ç½²æ›´æ–°"
git push origin main

# 3. Cloudflare Pages ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶éƒ¨ç½²
# æˆ–ä½¿ç”¨ Wrangler CLIï¼š
wrangler pages deploy dist
```

## ğŸ” éªŒè¯éƒ¨ç½²

éƒ¨ç½²åæ£€æŸ¥ï¼š

```bash
# 1. æ£€æŸ¥éƒ¨ç½²çŠ¶æ€ï¼ˆåœ¨ Cloudflare Dashboard ä¸­ï¼‰
# 2. è®¿é—®éƒ¨ç½²çš„ URL
# 3. æµ‹è¯• API ç«¯ç‚¹
curl https://your-site.pages.dev/api/auth/login
```

## ğŸ› ï¸ æ•…éšœæ’é™¤

### æ„å»ºå¤±è´¥

```bash
# æ¸…ç†å¹¶é‡æ–°å®‰è£…ä¾èµ–
rm -rf node_modules package-lock.json
npm install
npm run build
```

### Functions ä¸å·¥ä½œ

```bash
# æ£€æŸ¥ functions ç›®å½•æ˜¯å¦è¢«å¤åˆ¶
ls dist/functions/

# å¦‚æœæ²¡æœ‰ï¼Œæ‰‹åŠ¨å¤åˆ¶
node scripts/copy-functions.js
```

### éƒ¨ç½²å¤±è´¥

```bash
# æ£€æŸ¥ Wrangler ç™»å½•çŠ¶æ€
wrangler whoami

# é‡æ–°ç™»å½•
wrangler login
```

## ğŸ“ ç¯å¢ƒå˜é‡é…ç½®

åœ¨ Cloudflare Dashboard ä¸­é…ç½®ç¯å¢ƒå˜é‡ï¼š

1. è¿›å…¥ Pages é¡¹ç›®è®¾ç½®
2. é€‰æ‹© "Environment variables"
3. æ·»åŠ å˜é‡ï¼š
   - `JWT_SECRET`: JWT å¯†é’¥
   - å…¶ä»–éœ€è¦çš„ç¯å¢ƒå˜é‡

## ğŸ”— KV ç»‘å®šé…ç½®

1. åœ¨ Cloudflare Dashboard ä¸­åˆ›å»º KV Namespace
2. åœ¨ Pages é¡¹ç›®è®¾ç½®ä¸­é€‰æ‹© "Functions"
3. æ·»åŠ  KV Namespace ç»‘å®š
4. ç»‘å®šåç§°ï¼š`DB`ï¼ˆä¸ä»£ç ä¸­çš„ä¸€è‡´ï¼‰

## âš¡ ä¸€é”®éƒ¨ç½²è„šæœ¬

åˆ›å»º `deploy.sh`ï¼ˆLinux/Macï¼‰æˆ– `deploy.ps1`ï¼ˆWindowsï¼‰ï¼š

### Windows PowerShell (deploy.ps1)
```powershell
Write-Host "å¼€å§‹æ„å»º..." -ForegroundColor Green
npm run build

if ($LASTEXITCODE -eq 0) {
    Write-Host "æ„å»ºæˆåŠŸï¼Œå¼€å§‹éƒ¨ç½²..." -ForegroundColor Green
    wrangler pages deploy dist
} else {
    Write-Host "æ„å»ºå¤±è´¥ï¼Œè¯·æ£€æŸ¥é”™è¯¯" -ForegroundColor Red
}
```

### Linux/Mac (deploy.sh)
```bash
#!/bin/bash
echo "å¼€å§‹æ„å»º..."
npm run build

if [ $? -eq 0 ]; then
    echo "æ„å»ºæˆåŠŸï¼Œå¼€å§‹éƒ¨ç½²..."
    wrangler pages deploy dist
else
    echo "æ„å»ºå¤±è´¥ï¼Œè¯·æ£€æŸ¥é”™è¯¯"
    exit 1
fi
```

ä½¿ç”¨æ–¹æ³•ï¼š
```bash
# Windows
.\deploy.ps1

# Linux/Mac
chmod +x deploy.sh
./deploy.sh
```


